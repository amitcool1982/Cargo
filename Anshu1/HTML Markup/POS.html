<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Point of Sales - List</title>
    <link rel="shortcut icon" type="image/ico" href="http://admin.cargo.totalit.co.id/favicon.ico">
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      img.show_load{background: url('../../openbox/images/loader.gif') 50% 50% no-repeat;}
    </style>
    <!-- Add custom CSS here -->
    <link href="css/sb-admin.css" rel="stylesheet">
    <link rel="stylesheet" href="css/font-awesome.css">
    <!-- <link rel="stylesheet" href="http://admin.cargo.totalit.co.id/salesbox/css/morris-0.4.3.min.css"> -->
    <script src="css/jquery_002.js"></script>
  </head>

  <body>
    <div class="col-lg-4 col-lg-offset-4 text-center panel" id="loading-error-success" style="position:fixed;z-index:2;"></div>
    <div id="wrapper">
      <!-- Sidebar -->
      <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://admin.cargo.totalit.co.id/pos/index.html"><img src="images/logo_2.png" style="width: 180px;margin-top: -15px;margin-left: -12px;"> Administrator</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
                    <ul class="nav navbar-nav side-nav">
            <li><a href="http://admin.cargo.totalit.co.id/dashboard"><i class="fa fa-dashboard"></i> Dashboard</a></li>
            <li><a href="http://admin.cargo.totalit.co.id/pos/information"><i class="fa fa-user"></i> Point of Sale</a></li>
            <li><a href="http://admin.cargo.totalit.co.id/customer/information"><i class="fa fa-user"></i> Customer</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-shopping-cart"></i> Commerce <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="http://admin.cargo.totalit.co.id/commerce/vendors"><i class="fa fa-user"></i> Vendors</a></li>
                <li><a href="http://admin.cargo.totalit.co.id/commerce/items"><i class="fa fa-gift"></i> Items</a></li>
                <li><a href="http://admin.cargo.totalit.co.id/commerce/recommendation"><i class="fa fa-thumbs-up"></i> Recommendation Items</a></li>
                <li><a href="http://admin.cargo.totalit.co.id/commerce/promotion"><i class="fa fa-usd"></i> Promotions</a></li>
                <li><a href="http://admin.cargo.totalit.co.id/commerce/category"><i class="fa fa-filter"></i> Category</a></li>
                <li><a href="http://admin.cargo.totalit.co.id/commerce/tags"><i class="fa fa-tags"></i> Tags</a></li>
              </ul>
            </li>
            <li><a href="http://admin.cargo.totalit.co.id/pages/news"><i class="fa fa-list"></i> News</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-wrench"></i> Config <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="http://admin.cargo.totalit.co.id/config/user"><i class="fa fa-user"></i> Users</a></li>                 <li><a href="http://admin.cargo.totalit.co.id/config/city"><i class="fa fa-flag-o"></i> Province &amp; City</a></li>
                <li><a href="http://admin.cargo.totalit.co.id/config/templates/banner_assets"><i class="fa fa-picture-o"></i> Banner Assets</a></li>
                <li><a href="http://admin.cargo.totalit.co.id/config/faq"><i class="fa fa-question"></i> FAQ</a></li>
              </ul>
            </li>
            
          </ul>
                    <ul class="nav navbar-nav navbar-right navbar-user">
            
            <li class="dropdown user-dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i> Extraordinary Admin <b class="caret"></b></a>
              <ul class="dropdown-menu">
				<li><a href="http://admin.cargo.totalit.co.id/config/user/change_password"><i class="fa fa-lock"></i> Change Password</a></li>
                <li><a href="http://admin.cargo.totalit.co.id/auth/access/logout"><i class="fa fa-power-off"></i> Log Out</a></li>

            
          </ul>        </li></ul></div><!-- /.navbar-collapse -->
      </nav>

      <div id="page-wrapper">

        		
		<div class="row">
          <div class="col-lg-12">
            <h1>Point of Sales <small>List</small></h1>
            <ol class="breadcrumb">
              <li><a href="http://admin.cargo.totalit.co.id/pos/index.html"><i class="icon-dashboard"></i> Dashboard</a></li>
              <li class="active"><i class="icon-file-alt"></i> Point of Sales</li>
            </ol>
          </div>
        </div><!-- /.row -->
        <div class="row-fluid"><a class="btn btn-success" href="http://admin.cargo.totalit.co.id/pos/information/form_company">Create New Company POS</a> <a class="btn btn-success" href="http://admin.cargo.totalit.co.id/pos/information/form_personal">Create New Personal POS</a></div>
        <div class="row">
        	<div class="col-lg-12">
	        	<div class="table-responsive">	
		          	<div id="table_wrapper" class="dataTables_wrapper form-inline" role="grid"><div class="row-fluid"><div class="span6"></div><div class="span6"><div id="table_filter" class="dataTables_filter"><label>Search: <input aria-controls="table" type="text"></label></div></div></div><div class="dataTables_scroll"><div style="overflow: hidden; position: relative; border: 0px none; width: 100%;" class="dataTables_scrollHead"><div style="width: 1005px; padding-right: 0px;" class="dataTables_scrollHeadInner"><table style="margin-left: 0px; width: 1005px;" class="table table-hover table-striped tablesorter dataTable"><thead>
					        <tr role="row"><th aria-label="ID : activate to sort column descending" aria-sort="ascending" style="width: 117px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting_asc" width="8%">ID </th><th aria-label="Province : activate to sort column ascending" style="width: 62px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting">Province </th><th aria-label="City : activate to sort column ascending" style="width: 81px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting">City </th><th aria-label="Name: activate to sort column ascending" style="width: 75px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting">Name</th><th aria-label="Location : activate to sort column ascending" style="width: 61px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting">Location </th><th aria-label="Address : activate to sort column ascending" style="width: 329px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting">Address </th><th aria-label="Type : activate to sort column ascending" style="width: 63px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting">Type </th><th aria-label=": activate to sort column ascending" style="width: 73px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting" width="10%"><i class="fa fa-user"></i></th></tr>
				      	</thead></table></div></div><div style="overflow: auto; height: 176px; width: 100%;" class="dataTables_scrollBody"><table aria-describedby="table_info" style="margin-left: 0px; width: 100%;" id="table" class="table table-hover table-striped tablesorter dataTable"><thead>
					        <tr style="height: 0px;" role="row"><th aria-label="ID : activate to sort column descending" aria-sort="ascending" style="width: 117px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting_asc" width="8%"></th><th aria-label="Province : activate to sort column ascending" style="width: 62px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting"></th><th aria-label="City : activate to sort column ascending" style="width: 81px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting"></th><th aria-label="Name: activate to sort column ascending" style="width: 75px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting"></th><th aria-label="Location : activate to sort column ascending" style="width: 61px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting"></th><th aria-label="Address : activate to sort column ascending" style="width: 329px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting"></th><th aria-label="Type : activate to sort column ascending" style="width: 63px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting"></th><th aria-label=": activate to sort column ascending" style="width: 73px; padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px;" colspan="1" rowspan="1" aria-controls="table" tabindex="0" role="columnheader" class="header sorting" width="10%"></th></tr>
				      	</thead>
				      	
				    	
				    <tbody aria-relevant="all" aria-live="polite" role="alert"><tr class="odd">
				      			<td class="  sorting_1">744775103996</td>
				      			<td class=" ">Dki Jakarta</td>
                                <td class=" ">Jakarta Utara</td>
                                <td class=" ">CV Indah Mulia</td>
				      			<td class=" ">Ruko</td>
                                <td class=" ">Jalan persemakmuran no.23 ruko no.12</td>
                                <td class=" ">company</td>
				      			<td class=" ">
				      				<a href="http://admin.cargo.totalit.co.id/pos/information/form_company?id_pos=744775103996" data-id="744775103996" class="pos-show-form update-form" data-toggle="tooltip" title="update data pos"><i class="fa fa-edit fa-border"></i></a>
				      				<a href="#" data-id="744775103996" class="approve-pos" data-toggle="tooltip" title=" Delete approve"><i class="fa fa-times fa-border"></i></a>
				      				<a href="#" data-id="744775103996" class="delete-pos" data-toggle="tooltip" title="delete data pos"><i class="fa fa-trash-o fa-border"></i></a>
				      			</td>
				      		</tr><tr class="even">
				      			<td class="  sorting_1">118697220998962</td>
				      			<td class=" ">Dki Jakarta</td>
                                <td class=" ">Jakarta Selatan</td>
                                <td class=" ">totalit</td>
				      			<td class=" ">Mall</td>
                                <td class=" ">fatmawati</td>
                                <td class=" ">company</td>
				      			<td class=" ">
				      				<a href="http://admin.cargo.totalit.co.id/pos/information/form_company?id_pos=118697220998962" data-id="118697220998962" class="pos-show-form update-form" data-toggle="tooltip" title="update data pos"><i class="fa fa-edit fa-border"></i></a>
				      				<a href="#" data-id="118697220998962" class="approve-pos" data-toggle="tooltip" title=" Approve POS"><i class="fa fa-check fa-border"></i></a>
				      				<a href="#" data-id="118697220998962" class="delete-pos" data-toggle="tooltip" title="delete data pos"><i class="fa fa-trash-o fa-border"></i></a>
				      			</td>
				      		</tr><tr class="odd">
				      			<td class="  sorting_1">153358004209668</td>
				      			<td class=" ">Dki Jakarta</td>
                                <td class=" ">Jakarta Selatan</td>
                                <td class=" ">Ryan Gemilang</td>
				      			<td class=" ">Ruko</td>
                                <td class=" ">Jalan Mawar 5 Ruko Griya Merdeka no.21 Kebayoran Baru</td>
                                <td class=" ">personal</td>
				      			<td class=" ">
				      				<a href="http://admin.cargo.totalit.co.id/pos/information/form_personal?id_pos=153358004209668" data-id="153358004209668" class="pos-show-form update-form" data-toggle="tooltip" title="update data pos"><i class="fa fa-edit fa-border"></i></a>
				      				<a href="#" data-id="153358004209668" class="approve-pos" data-toggle="tooltip" title=" Delete approve"><i class="fa fa-times fa-border"></i></a>
				      				<a href="#" data-id="153358004209668" class="delete-pos" data-toggle="tooltip" title="delete data pos"><i class="fa fa-trash-o fa-border"></i></a>
				      			</td>
				      		</tr></tbody></table></div></div><div class="row-fluid"><div class="span6"><div id="table_info" class="dataTables_info">Showing 1 to 3 of 3 entries</div></div><div class="span6"></div></div></div>
				</div>
			</div>
        </div>
		<!-- Modal -->
        <div class="modal fade" id="modalConfirmDelete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-sm">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel">Delete Confirm</h4>
              </div>
              <div class="modal-body">
                Are you sure, you want to delete this Point of Sales?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
                <button type="button" class="btn btn-primary" id="delete-confirmed">Yes</button>
              </div>
            </div>
          </div>
        </div>

<link href="css/DT_bootstrap.css" rel="stylesheet" media="screen">
<script src="js/jquery.js"></script>
<script src="js/DT_bootstrap.js"></script>
<script>

var base = $('#base').text();
var message   = {
    Seletor:function(sel){
        if(typeof(sel)==='undefined') sel = $('#loading-error-success');
        return sel;
    },
    T_error:function(mess){
        return '<div class="alert alert-dismissable alert-danger" style="margin-bottom:4px;padding:2px;"><button type="button" class="close" data-dismiss="alert">×</button>'+mess+'</div>';
    },
    T_success:function(mess){
        return '<div class="alert alert-dismissable alert-success" style="margin-bottom:4px;padding:2px;"><button type="button" class="close" data-dismiss="alert">×</button>'+mess+'</div>';
    },
    Error:function(mess,mode,sel){
        if(typeof(mode)==='undefined') mode = 'replace';
        def_selector = message.Seletor(sel);
        if(mode == 'add'){
            def_selector.append(message.T_error(mess));
        }
        else if(mode == 'replace'){
            def_selector.html(message.T_error(mess));   
        }
        
    },
    Success:function(mess,mode,sel){
        if(typeof(mode)==='undefined') mode = 'replace';
        def_selector = message.Seletor(sel);
        if(mode == 'add'){
            def_selector.append(message.T_success(mess));
        }
        else if(mode == 'replace'){
            def_selector.html(message.T_success(mess)); 
        }
    },
    Clean:function(){
        var sel = message.Seletor();
        sel.html('');
    },
    Loading:function(){
        var sel = message.Seletor();
        sel.hide().html('<img src="../../openbox/images/loader.gif"> Please Wait..').fadeIn('fast');
    }
};

$(document).ready(function() {
  	var dtbl = $('#table').dataTable({
        "bDeferRender": true,   
        "bScrollInfinite": true,
        "bScrollCollapse": true,
        "sScrollY": "500px",
        "oLanguage": {
            "sLengthMenu": "_MENU_"
        }
    });

    var refreshData = {
        POS:function(id,list){
            if(typeof(list)==='undefined') list = 'detail';
            if(typeof(id)==='undefined') id = false;
            
            var def_url = '';
            if(list == 'detail') def_url = 'information/get_pos_detail_json?id_category='+id;
            else def_url = 'information/pos_list_json';
            
            var ret = '';
            var Rpos   =   $.ajax({
                type     : 'GET',
                url      : base+def_url,
                dataType : 'json',
                timeout  : 15000,
                async: false,
                beforeSend : function(){
                    message.Loading();
                }
            }); 
            Rpos.done(function(response){
                ret = {status:response.status,message:response.message};
            });
            Rpos.fail(function(xhr,response){
                ret = {status:false,message:response};
            });
            return ret;
        },
        POSAsTable:function(){
            var data = refreshData.POS(false,'list');
            if(data.status){
                var table = '';
                $.each(data.message, function(key,value){
                	var title = (value['is_approved'])?'delete approve pos':'approve pos';
                	var classi = (value['is_approved'])?'fa-times':'fa-check';

                    table += '<tr>';
                        table += '<td>'+value['id_agen_generator']+'</td>';
                        table += '<td>'+ucwords(str_replace('_',' ',value['daerah']))+'</td>';
                        table += '<td>'+ucwords(str_replace('_',' ',value['kota']))+'</td>';
                        table += '<td>'+value['name']+'</td>';
                        table += '<td>'+value['tipe_lokasi']+'</td>';
                        table += '<td>'+value['alamat_lokasi']+'</td>';
                        table += '<td>'+value['tlp_lokasi']+'</td>';
                        table += '<td>';
                            table += '<a href="'+base+'pos/information/form?id_pos='+value['id_agen_generator']+'" data-id="'+value['id_agen_generator']+'" class="pos-show-form update-form" data-toggle="tooltip" title="update data pos"><i class="fa fa-edit fa-border"></i></a>';
                            table += '<a href="#" data-id="'+value['id_agen_generator']+'" class="approve-pos" data-toggle="tooltip" title="'+title+'"><i class="fa '+classi+' fa-border"></i></a>';
                            table += '<a href="#" data-id="'+value['id_agen_generator']+'" class="delete-pos" data-toggle="tooltip" title="delete data pos"><i class="fa fa-trash-o fa-border"></i></a></td>';
                    table += '</tr>';
                });
                dtbl.fnDestroy();
                $('#table tbody').html(table);
                $('#table').dataTable({
                    "bDeferRender": true,   
                    "bScrollInfinite": true,
                    "bScrollCollapse": true,
                    "sScrollY": "500px",
                    "oLanguage": {
                        "sLengthMenu": "_MENU_"
                    }
                });
            }
            else{
                var empty = '<tr class="odd"><td valign="top" colspan="4" class="dataTables_empty">No data available in table</td></tr>'
                dtbl.fnDestroy();
                $('#table tbody').html(empty);
            }
        }
    };


    $(document).on('click','a.approve-pos',function(){
    	var id = $(this).attr('data-id');
        var approve = $.ajax({
            type     : 'GET',
            url      : 'information/approve_pos',
            dataType : 'json',
            data     : {id_pos:id},
            timeout  : 15000,
            beforeSend : function(){
                message.Loading();
            }
        });
        approve.done(function(response){
            if(response.status){
            	if(response.message.status){
            		$('a[data-id="'+id+'"]').find('i.fa').removeClass('fa-check');
            		$('a[data-id="'+id+'"]').find('i.fa').addClass('fa-times');
            		$('a[data-id="'+id+'"]').attr('title','Delete Approve');
            	}
            	else{
            		$('a[data-id="'+id+'"]').find('i.fa').removeClass('fa-times');
            		$('a[data-id="'+id+'"]').find('i.fa').addClass('fa-check');
            		$('a[data-id="'+id+'"]').attr('title','Approve POS');
            	}
                message.Success(response.message.message);
            }
            else{
                message.Error(response.message);
            }
        });
        approve.fail(function(xhr,response){
            alert(response);
        });
    });

	$(document).on('click','.delete-pos',function(){
        var id = $(this).attr('data-id');
        $('#delete-confirmed').attr('data-id',id);
        $('#modalConfirmDelete').modal({
              keyboard: false
            });
    });
    $('#modalConfirmDelete').on('click','#delete-confirmed',function(){
        var pos    =   $.ajax({
            type     : 'GET',
            url      : 'information/delete_pos',
            dataType : 'json',
            data     : {id_pos:$(this).attr('data-id')},
            timeout  : 15000,
            beforeSend : function(){
                message.Loading();
            }
        }); 
        pos.done(function(response){
            if(response.status){
                refreshData.POSAsTable();
                message.Success(response.message);
                $(this).attr('data-id','');
            }
            else{
                message.Error(response.message);
            }
        });
        pos.fail(function(xhr,response){
            message.Error(response);
        });
        $('#modalConfirmDelete').modal('hide');
    });


});

function str_replace (search, replace, subject, count) {
  var i = 0,
    j = 0,
    temp = '',
    repl = '',
    sl = 0,
    fl = 0,
    f = [].concat(search),
    r = [].concat(replace),
    s = subject,
    ra = Object.prototype.toString.call(r) === '[object Array]',
    sa = Object.prototype.toString.call(s) === '[object Array]';
  s = [].concat(s);
  if (count) {
    this.window[count] = 0;
  }

  for (i = 0, sl = s.length; i < sl; i++) {
    if (s[i] === '') {
      continue;
    }
    for (j = 0, fl = f.length; j < fl; j++) {
      temp = s[i] + '';
      repl = ra ? (r[j] !== undefined ? r[j] : '') : r[0];
      s[i] = (temp).split(f[j]).join(repl);
      if (count && s[i] !== temp) {
        this.window[count] += (temp.length - s[i].length) / f[j].length;
      }
    }
  }
  return sa ? s : s[0];
}

function ucwords(str) {
  return (str + '')
    .replace(/^([a-z\u00E0-\u00FC])|\s+([a-z\u00E0-\u00FC])/g, function($1) {
      return $1.toUpperCase();
    });
}

</script>

      </div><!-- /#page-wrapper -->

    </div><!-- /#wrapper -->
    
    <div id="base" style="display:none;">http://admin.cargo.totalit.co.id/</div>
    <!-- Bootstrap core JavaScript -->
    <script src="js/bootstrap.js"></script>
    <!--<script src="http://admin.cargo.totalit.co.id/adminbox/js/tablesorter/jquery.tablesorter.js"></script>
    <script src="http://admin.cargo.totalit.co.id/adminbox/js/tablesorter/tables.js"></script> -->
    <script src="js/bootstrap-datepicker.js"></script>
    <link href="css/datepicker.css" rel="stylesheet">
    <script> $('#datepicker').datepicker({format: 'yyyy-mm-dd'});</script>
    <script>
      $(document).ready(function(){
        $('body').tooltip({
            selector: '[data-toggle="tooltip"]'
        });
      });
    </script>
  
</body></html>